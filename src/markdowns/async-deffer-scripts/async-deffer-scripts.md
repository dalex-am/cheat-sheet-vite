### Теги async и defer при использовании \<script\>

Пример обычной загрузки скрипта:

```html
<html>
  <head>
    ...
  </head>
  <body>
    <div>...</div>
    <script src="script.js"></script>
  </body>
</html>
```

В этом случае парсинг HTML приостанавливается, пока скрипт не будет загружен и выполнен. Увеличивается время до первой отрисовки:

![usual-import](https://habrastorage.org/r/w1560/files/fc6/581/de4/fc6581de40d249e5905cf3fa238286eb.png)

#### Атрибут _async_

```html
<script async src="script.js"></script>
```

Если скрипт загружается с атрибутом async, то парсинг html не прекращается **во время загрузки** файла:

![async-import](https://habrastorage.org/r/w1560/files/a07/823/bae/a07823bae90b4612bc5e4933674b34ce.png)

Если существует несколько скриптов с async, они могут выполняться в любом порядке. То, что первое загрузится – запустится в первую очередь.

Скрипты, загружаемые как модули с атрибутом async (`<script async type="module" src="...">`), выполнятся сразу после загрузки.

Данный атрибут может быть полезен для файлов, не имеющих никаких зависимостей, т.к. в этой ситуации не важно, когда файл будет исполнен.

#### Атрибут _defer_

```html
<script defer src="script.js"></script>
```

Атрибут defer сообщает браузеру, что он должен продолжать обрабатывать страницу и загружать скрипт в фоновом режиме, а затем запустить этот скрипт, когда DOM дерево будет полностью построено (выполнится событие `DOMContentLoaded`):

![async-import](https://habrastorage.org/r/w1560/files/378/af7/eff/378af7eff5e34d89b75584d626c48cae.png)

Отложенные с помощью defer скрипты сохраняют порядок относительно друг друга, как и обычные скрипты. Размер файлов не будет иметь значения.

Скрипты, загружаемые как модули без атрибута `async`, также выполняются в отложенном режиме.

Таким образом, если для выполнения скрипта необходимо DOM-дерево, но при этом разместить скрипт в конце документа невозможно, атрибут defer становится полезным.
